<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-carbon-copies/WebOfTrust-keria-main-docs-protocol">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">WebOfTrust-keria-main-docs-protocol | KERISSE.org</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://weboftrust.github.io/WOT-terms/docs/carbon-copies/WebOfTrust-keria-main-docs-protocol"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="WebOfTrust-keria-main-docs-protocol | KERISSE.org"><meta data-rh="true" name="description" content="signify-keria-request-authentication-protocol--skrap-, level 1"><meta data-rh="true" property="og:description" content="signify-keria-request-authentication-protocol--skrap-, level 1"><link data-rh="true" rel="icon" href="/WOT-terms/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://weboftrust.github.io/WOT-terms/docs/carbon-copies/WebOfTrust-keria-main-docs-protocol"><link data-rh="true" rel="alternate" href="https://weboftrust.github.io/WOT-terms/docs/carbon-copies/WebOfTrust-keria-main-docs-protocol" hreflang="en"><link data-rh="true" rel="alternate" href="https://weboftrust.github.io/WOT-terms/docs/carbon-copies/WebOfTrust-keria-main-docs-protocol" hreflang="x-default"><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script><link rel="stylesheet" href="/WOT-terms/assets/css/styles.18d8ba11.css">
<link rel="preload" href="/WOT-terms/assets/js/runtime~main.21a352a1.js" as="script">
<link rel="preload" href="/WOT-terms/assets/js/main.dccd3833.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/WOT-terms/"><div class="navbar__logo"><img src="/WOT-terms/img/stamp.png" alt="KERISSE Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/WOT-terms/img/stamp.png" alt="KERISSE Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">KERISSE</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/WOT-terms/docs/intro/intro">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/WOT-terms/docs/how-we-did/cheat-sheet-writing-page">For contributors to this website</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/WOT-terms/docs/concepts/how-to/intro">How to</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/set-up-basic-keri-network">Set up a basic KERI network</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/create-a-basic-acdc-graph">Create a basic ACDC graph</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/make-a-schema">Make a schema</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/issue-a-credential">Issue a credential</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/present-a-credential">Present a credential</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/verify-a-credential">Verify a credential</a></li><li><a class="dropdown__link" href="/WOT-terms/docs/concepts/how-to/current-open-issues">Current open issues</a></li></ul></div><a class="navbar__item navbar__link" href="/WOT-terms/feedback">Feedback</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/weboftrust/WOT-terms" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub repo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/intro">Intro</a><button aria-label="Toggle the collapsible sidebar category &#x27;Intro&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/visualisations">Visualisations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Visualisations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/glossary">Glossary</a><button aria-label="Toggle the collapsible sidebar category &#x27;Glossary&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/resources">Resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/concepts">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/education">Education</a><button aria-label="Toggle the collapsible sidebar category &#x27;Education&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/WOT-terms/docs/category/anotated-copies">Anotated Copies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Anotated Copies&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/WOT-terms/docs/carbon-copies/WebOfTrust-ietf-acdc-main-draft-ssmith-acdc">WebOfTrust-ietf-acdc-main-draft-ssmith-acdc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/WOT-terms/docs/carbon-copies/WebOfTrust-ietf-cesr-proof-main-draft-pfeairheller-cesr-proof">WebOfTrust-ietf-cesr-proof-main-draft-pfeairheller-cesr-proof</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/WOT-terms/docs/carbon-copies/WebOfTrust-ietf-ipex-main-draft-ssmith-ipex">WebOfTrust-ietf-ipex-main-draft-ssmith-ipex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/WOT-terms/docs/carbon-copies/WebOfTrust-keria-main-docs-protocol">WebOfTrust-keria-main-docs-protocol</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/gleif">GLEIF</a><button aria-label="Toggle the collapsible sidebar category &#x27;GLEIF&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/WOT-terms/docs/glossary-ToIP/">ToIP Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/how-we-did">How we did</a><button aria-label="Toggle the collapsible sidebar category &#x27;How we did&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/test">Test</a><button aria-label="Toggle the collapsible sidebar category &#x27;Test&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WOT-terms/docs/category/video">Video</a><button aria-label="Toggle the collapsible sidebar category &#x27;Video&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/WOT-terms/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/WOT-terms/docs/category/anotated-copies"><span itemprop="name">Anotated Copies</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">WebOfTrust-keria-main-docs-protocol</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>WebOfTrust-keria-main-docs-protocol</h1></header><div class="accordion accordion-flush" id="annotated-copies"><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersignify-keria-request-authentication-protocol--skrap-"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-signify-keria-request-authentication-protocol--skrap-" aria-expanded="false" aria-controls="accordeon-signify-keria-request-authentication-protocol--skrap-">signify-keria-request-authentication-protocol--skrap-, level 1</button><a href="#headersignify-keria-request-authentication-protocol--skrap-" class="hash-link" aria-label="Direct link to headersignify-keria-request-authentication-protocol--skrap-" title="Direct link to headersignify-keria-request-authentication-protocol--skrap-">​</a></h2><div id="accordeon-signify-keria-request-authentication-protocol--skrap-" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signifykeria-request-authentication-protocol-skrap">Signify/KERIA Request Authentication Protocol (SKRAP)<a href="#signifykeria-request-authentication-protocol-skrap" class="hash-link" aria-label="Direct link to Signify/KERIA Request Authentication Protocol (SKRAP)" title="Direct link to Signify/KERIA Request Authentication Protocol (SKRAP)">​</a></h2></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerkeria-service-endpoint-interfaces"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-keria-service-endpoint-interfaces" aria-expanded="false" aria-controls="accordeon-keria-service-endpoint-interfaces">keria-service-endpoint-interfaces, level 1</button><a href="#headerkeria-service-endpoint-interfaces" class="hash-link" aria-label="Direct link to headerkeria-service-endpoint-interfaces" title="Direct link to headerkeria-service-endpoint-interfaces">​</a></h2><div id="accordeon-keria-service-endpoint-interfaces" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="keria-service-endpoint-interfaces">KERIA Service Endpoint Interfaces<a href="#keria-service-endpoint-interfaces" class="hash-link" aria-label="Direct link to KERIA Service Endpoint Interfaces" title="Direct link to KERIA Service Endpoint Interfaces">​</a></h2><p>The KERIA service will expose 3 separate HTTP endpoints on 3 separate network interfaces.</p><ol><li>Boot Interface - Exposes one endpoint for Agent Worker initialization.</li><li>Admin Interface - The REST API for command and control operations from the Signify Client.</li><li>KERI Protocol Interface - CESR over HTTP endpoint for KERI protocol interactions with the rest of the world.</li></ol><p>This separation allows for the Boot interface to be expose to internal infrastructure only (or disabled all together) while exposing the other two interfaces externally.  If a KERIA instance is launched in static worker mode, meaning all agent workers are configured at start up only the Boot interface can be disabled completely.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headeragent-worker-initialization"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-agent-worker-initialization" aria-expanded="false" aria-controls="accordeon-agent-worker-initialization">agent-worker-initialization, level 1</button><a href="#headeragent-worker-initialization" class="hash-link" aria-label="Direct link to headeragent-worker-initialization" title="Direct link to headeragent-worker-initialization">​</a></h2><div id="accordeon-agent-worker-initialization" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agent-worker-initialization">Agent Worker Initialization<a href="#agent-worker-initialization" class="hash-link" aria-label="Direct link to Agent Worker Initialization" title="Direct link to Agent Worker Initialization">​</a></h2><p>To initiate a connection between a Signify Client and a KERIA agent, the two sides will exchange KERI AIDs with the Signify Client AID (called the &quot;Client AID&quot;) being the delegator for the KERIA agent worker AID (called the &quot;Agent AID&quot;).  To establish the connection the following steps are performed:</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerstep-one---generate-client-aid"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-step-one---generate-client-aid" aria-expanded="false" aria-controls="accordeon-step-one---generate-client-aid">step-one---generate-client-aid, level 1</button><a href="#headerstep-one---generate-client-aid" class="hash-link" aria-label="Direct link to headerstep-one---generate-client-aid" title="Direct link to headerstep-one---generate-client-aid">​</a></h2><div id="accordeon-step-one---generate-client-aid" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-one--generate-client-aid">Step One:  Generate Client AID<a href="#step-one--generate-client-aid" class="hash-link" aria-label="Direct link to Step One:  Generate Client AID" title="Direct link to Step One:  Generate Client AID">​</a></h2><p>The Signify Client generates the client AID as a transferable AID with a single signing key and single rotation key and provides the signed inception event out-of-bands to the KERIA service through the Boot interface. The HTTP request must be signed by the client AID using Signify Request Authentication described below.  The algorithm for generating the signing and rotation key pairs for Client AID is as follows:</p><ol><li>Prepend the 128 bit random salt derivation code (&#x27;0A&#x27;) plus the blank qualified base 64 character (&#x27;A&#x27;) to the provided 21 character passcode</li><li>Stretch the passcode derivation using Argon2 to generate an Ed25519 private key from the provided &quot;tier&quot; and paths of <code>signify:controller00</code> and <code>signify:controller01</code> for the signing key and rotation key respectively.</li><li>Use the qualified base64 of the signing public key and the qualified base64 of the Blake3 digest of the rotation public key in the inception event.</li></ol><p>The follow is an example of a Client AID generated by the SignifyPy (Python implementation) Signify Client with a passcode of <code>0123456789abcdefghijk</code></p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;v&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KERI10JSON00012b_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;t&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;icp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELI7pg979AdhmvrjDeam2eAO2SR5niCgnjAJXJHtJose&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;i&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELI7pg979AdhmvrjDeam2eAO2SR5niCgnjAJXJHtJose&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Client AID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;s&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;kt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;k&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;DAbWjobbaLqRB94KiAutAHb_qzPpOHm3LURA_ksxetVc&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Derived from passcode as salt, kidx = 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;nt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;EIFG_uqfr1yN560LoHYHfvPAhxQ5sN6xZZT_E3h7d2tL&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Derived from passcode as salt, kidx = 1, Blake3 Hashed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;bt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerstep-two---agent-worker-creation"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-step-two---agent-worker-creation" aria-expanded="false" aria-controls="accordeon-step-two---agent-worker-creation">step-two---agent-worker-creation, level 1</button><a href="#headerstep-two---agent-worker-creation" class="hash-link" aria-label="Direct link to headerstep-two---agent-worker-creation" title="Direct link to headerstep-two---agent-worker-creation">​</a></h2><div id="accordeon-step-two---agent-worker-creation" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-two--agent-worker-creation">Step Two:  Agent Worker Creation<a href="#step-two--agent-worker-creation" class="hash-link" aria-label="Direct link to Step Two:  Agent Worker Creation" title="Direct link to Step Two:  Agent Worker Creation">​</a></h2><p>The KERIA service will create an Agent Worker on behalf of the new client and create the delegated, transferable Agent AID
with a single signing key and single rotation key specifying the Client AID as its delegator in its inception event.<br>
<!-- -->The KERIA service will return the Agent AID inception event in a signed HTTP response, signed by the Agent AID.  Agent AID keys
can be generated using a salt or truly random depending on the requirements of the service hosting the KERIA service.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;v&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KERI10JSON00015f_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;t&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dip&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Delegated AID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EEXekkGu9IAzav6pZVJhkLnjtjM5v3AcyA-pdKUcaGei&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;i&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EEXekkGu9IAzav6pZVJhkLnjtjM5v3AcyA-pdKUcaGei&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Agent AID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;s&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;kt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;k&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;DMZh_y-H5C3cSbZZST-fqnsmdNTReZxIh0t2xSTOJQ8a&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;nt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;EM9M2EQNCBK0MyAhVYBvR98Q0tefpvHgE-lHLs82XgqC&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;bt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;di&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELI7pg979AdhmvrjDeam2eAO2SR5niCgnjAJXJHtJose&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Delegated signing authority from Client AID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerstep-three--signify-client-delegation-approval"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-step-three--signify-client-delegation-approval" aria-expanded="false" aria-controls="accordeon-step-three--signify-client-delegation-approval">step-three--signify-client-delegation-approval, level 1</button><a href="#headerstep-three--signify-client-delegation-approval" class="hash-link" aria-label="Direct link to headerstep-three--signify-client-delegation-approval" title="Direct link to headerstep-three--signify-client-delegation-approval">​</a></h2><div id="accordeon-step-three--signify-client-delegation-approval" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-three-signify-client-delegation-approval">Step Three: Signify Client Delegation Approval<a href="#step-three-signify-client-delegation-approval" class="hash-link" aria-label="Direct link to Step Three: Signify Client Delegation Approval" title="Direct link to Step Three: Signify Client Delegation Approval">​</a></h2><p><em>Note that all HTTP requests against the Admin Interface must be signed by the Client AID and expect all responses to be signed by the Agent AID.</em></p><p>The Signify Client will approve the delegation of the client AID with an interaction event that it sends back to the KERIA service over the Admin interface.</p><p>Once these steps are complete the Signify Client can begin using the rest of the Admin interface to create AIDs, issue credentials, etc.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerreconnecting-to-existing-agent-worker"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-reconnecting-to-existing-agent-worker" aria-expanded="false" aria-controls="accordeon-reconnecting-to-existing-agent-worker">reconnecting-to-existing-agent-worker, level 1</button><a href="#headerreconnecting-to-existing-agent-worker" class="hash-link" aria-label="Direct link to headerreconnecting-to-existing-agent-worker" title="Direct link to headerreconnecting-to-existing-agent-worker">​</a></h2><div id="accordeon-reconnecting-to-existing-agent-worker" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reconnecting-to-existing-agent-worker">Reconnecting to Existing Agent Worker<a href="#reconnecting-to-existing-agent-worker" class="hash-link" aria-label="Direct link to Reconnecting to Existing Agent Worker" title="Direct link to Reconnecting to Existing Agent Worker">​</a></h2><p>Document the steps for retrieving state from the Admin interface and updating.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerkey-generate-methods"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-key-generate-methods" aria-expanded="false" aria-controls="accordeon-key-generate-methods">key-generate-methods, level 1</button><a href="#headerkey-generate-methods" class="hash-link" aria-label="Direct link to headerkey-generate-methods" title="Direct link to headerkey-generate-methods">​</a></h2><div id="accordeon-key-generate-methods" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-generate-methods">Key Generate Methods<a href="#key-generate-methods" class="hash-link" aria-label="Direct link to Key Generate Methods" title="Direct link to Key Generate Methods">​</a></h2><p>The KERIA service supports the following key generation methods where the Signify Client generates the keys and only ever sends encrypted key material (if any) to the server.</p><ol><li>Salty Keys - HDK key chain generated from a salt per aid that is encrypted and stored server.</li><li>Randy Keys - Randomly generated keys (signing and rotation) that are encrypted and store on the server.</li><li>Sandy Keys - Keys generated from a different salt for inception and each rotation.  </li><li>Group Keys - Signify Client/KERIA Service AIDs participating in a distributed group multisig AID.</li><li>HSM Keys - Signify Client uses a Signify HSM Integration Module (SHIM) to manage keys and signatures.</li></ol><p>For all key generation methods, the Signify Client creates and signs all KERI events, credentials, etc. ensuring that unencrypted private key material never leaves the client. The key generate methods are descrive in more detail in the following sections.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersalty-keys"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-salty-keys" aria-expanded="false" aria-controls="accordeon-salty-keys">salty-keys, level 1</button><a href="#headersalty-keys" class="hash-link" aria-label="Direct link to headersalty-keys" title="Direct link to headersalty-keys">​</a></h2><div id="accordeon-salty-keys" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="salty-keys">Salty Keys<a href="#salty-keys" class="hash-link" aria-label="Direct link to Salty Keys" title="Direct link to Salty Keys">​</a></h2><p>The Salty Key algorithm is used to create a hierarchical deterministic key chain for each AID by generating a unique random salt for each AID and stretching the salt using Argon2 with a <code>path</code> that is calculated from the AIDs index relative to all other AIDs and the key index calculated by the total number of signing and rotation keys over the lifetime of the AID.</p><p>The salt for each AID is encrypted with the X25519 encryption key generated from the passcode and stored on the server with other AID metadata, including the AID index and current key index.  </p><p>The Signify Client API must accept the AID salt as an optional parameter to creating Salty Key AIDs allowing users to manage AID salts externally or to share Salts across AIDs if required.</p><p>The following Python data class represents the metadata storage for Salty Key AIDs:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SaltyPrm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Salty prefix&#x27;s parameters for creating new key pairs</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sxlt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># qualified b64 encoded AID salt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pidx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># prefix index for this keypair sequence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kidx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># key index for this keypair sequence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stem</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default unique path stem for salty algo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># security tier for stretch index salty algo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dcode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># next digest hasing code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    icodes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default_factory</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># current signing key seed codes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ncodes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default_factory</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># next key seed codes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transferable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersalty-key-salt-rotations"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-salty-key-salt-rotations" aria-expanded="false" aria-controls="accordeon-salty-key-salt-rotations">salty-key-salt-rotations, level 1</button><a href="#headersalty-key-salt-rotations" class="hash-link" aria-label="Direct link to headersalty-key-salt-rotations" title="Direct link to headersalty-key-salt-rotations">​</a></h2><div id="accordeon-salty-key-salt-rotations" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="salty-key-salt-rotations">Salty Key Salt Rotations<a href="#salty-key-salt-rotations" class="hash-link" aria-label="Direct link to Salty Key Salt Rotations" title="Direct link to Salty Key Salt Rotations">​</a></h2><p>Document the procedure for rotating a new Salt in for a Salty Key AID.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerrandy-keys"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-randy-keys" aria-expanded="false" aria-controls="accordeon-randy-keys">randy-keys, level 1</button><a href="#headerrandy-keys" class="hash-link" aria-label="Direct link to headerrandy-keys" title="Direct link to headerrandy-keys">​</a></h2><div id="accordeon-randy-keys" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="randy-keys">Randy Keys<a href="#randy-keys" class="hash-link" aria-label="Direct link to Randy Keys" title="Direct link to Randy Keys">​</a></h2><p>The Randy Key algorithm allows for all signing and rotation private keys to be generated solely from entropy and encrypted with the X25519 encryption key generated from the passcode and stored on the server alongside other AID metadata.</p><p>The server stores the encrypted private key material for signing and rotation keys in separate LMBD sub-databases as indexed qualified base 64 CESR encoded Cipher representations. </p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersandy-keys"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-sandy-keys" aria-expanded="false" aria-controls="accordeon-sandy-keys">sandy-keys, level 1</button><a href="#headersandy-keys" class="hash-link" aria-label="Direct link to headersandy-keys" title="Direct link to headersandy-keys">​</a></h2><div id="accordeon-sandy-keys" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sandy-keys">Sandy Keys<a href="#sandy-keys" class="hash-link" aria-label="Direct link to Sandy Keys" title="Direct link to Sandy Keys">​</a></h2></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headergroup-keys"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-group-keys" aria-expanded="false" aria-controls="accordeon-group-keys">group-keys, level 1</button><a href="#headergroup-keys" class="hash-link" aria-label="Direct link to headergroup-keys" title="Direct link to headergroup-keys">​</a></h2><div id="accordeon-group-keys" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="group-keys">Group Keys<a href="#group-keys" class="hash-link" aria-label="Direct link to Group Keys" title="Direct link to Group Keys">​</a></h2><p>The Group Key algorithm is a special key generation algorith for distributed group multisig AIDs that does not manage and keys at all.  Instead this algoritm allows for the specification of an AID of one of the other three types to be the &quot;local&quot; participant in a distributed group multisig AID.  </p><p>All signing operations must be performed on the Signify Client on behalf of the &quot;local&quot; AID for this Signify Client indexed based on the local AID&#x27;s location in both the signing key list and the rotation key list.  </p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerhsm-keys--experimental-"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-hsm-keys--experimental-" aria-expanded="false" aria-controls="accordeon-hsm-keys--experimental-">hsm-keys--experimental-, level 1</button><a href="#headerhsm-keys--experimental-" class="hash-link" aria-label="Direct link to headerhsm-keys--experimental-" title="Direct link to headerhsm-keys--experimental-">​</a></h2><div id="accordeon-hsm-keys--experimental-" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hsm-keys-experimental">HSM Keys (Experimental)<a href="#hsm-keys-experimental" class="hash-link" aria-label="Direct link to HSM Keys (Experimental)" title="Direct link to HSM Keys (Experimental)">​</a></h2><p>The SignifyPy Signify Client defines an experimental interface for declaring external modules that can be used as Signify HSM Integration Modules to allow all key generation and event signing to occur in an external Hardware Security Module (HSM).  </p><p>Two sample implementations have been defined to date, one using the Google KSM and one using a Trezure One external HSM.</p><p>The following psuedo Python class represents the current, experimental interface a SHIM has to implememnt to work with SignifyPy.  It is anticipated that each Signify Client implementation defines a similar interface.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Shim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">incept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> transferable</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;  Create an AID using the Google KSM for key generation and event signing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            transferable (bool):  True means create a transferable AID which allows for key rotation</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            keys (list): list of qualified base64 public signing key deriviations based on the codes passed into init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            ndigs (list): list of qualified base64 digests of public rotation key derivations based on the codes</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">                          passed into init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rotate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ncount</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> transferable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;  Rotate an AID using the Google KSM for key generation and event signing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            ncount (int): number of new rotation keys to generate</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            transferable (bool):  True means create a transferable AID which allows for key rotation</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            keys (list): list of qualified base64 public signing key deriviations based on the codes passed into init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            ndigs (list): list of qualified base64 digests of public rotation key derivations based on the codes</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">                          passed into init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ser</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> indexed</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> indices</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ondices</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            ser (bytes): content to be signed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            indexed (bool): True means generated indexed signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            indices (list): Optional list of indices to use when generating indexed signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            ondices (list): Optional list of rotation indices to use when generating dual indexed signatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            **_: Placeholder</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            sigs (list): list of qualified base64 signatures over the based in ser</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerpasscode-rotation"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-passcode-rotation" aria-expanded="false" aria-controls="accordeon-passcode-rotation">passcode-rotation, level 1</button><a href="#headerpasscode-rotation" class="hash-link" aria-label="Direct link to headerpasscode-rotation" title="Direct link to headerpasscode-rotation">​</a></h2><div id="accordeon-passcode-rotation" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="passcode-rotation">Passcode Rotation<a href="#passcode-rotation" class="hash-link" aria-label="Direct link to Passcode Rotation" title="Direct link to Passcode Rotation">​</a></h2><p>To perform a passcode rotation, the Signify Client requires both old and new passcodes and must perform the following steps:</p><ol><li>Encrypted the old passcode with X25519 key generated from the new passcode.</li><li>Perform a partial rotation of the Client AID as described below.</li><li>Decrypt all salts with X25519 key from old passcode for Salty Keys, validate them against current public keys, encrypt with X25519 key from new passcode</li><li>Decrypt all keys with X25519 key from old passcode for Randy Keys, validate them against current public keys, encrypt with X25519 key from new passcode</li><li>Send all rotation event and all recrypted material in a POST request to the agent on <code>/agent/&lt;Client AID&gt;</code></li></ol></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerpartial-client-aid-rotaion-in-support-of-passcode-rotation"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-partial-client-aid-rotaion-in-support-of-passcode-rotation" aria-expanded="false" aria-controls="accordeon-partial-client-aid-rotaion-in-support-of-passcode-rotation">partial-client-aid-rotaion-in-support-of-passcode-rotation, level 1</button><a href="#headerpartial-client-aid-rotaion-in-support-of-passcode-rotation" class="hash-link" aria-label="Direct link to headerpartial-client-aid-rotaion-in-support-of-passcode-rotation" title="Direct link to headerpartial-client-aid-rotaion-in-support-of-passcode-rotation">​</a></h2><div id="accordeon-partial-client-aid-rotaion-in-support-of-passcode-rotation" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="partial-client-aid-rotaion-in-support-of-passcode-rotation">Partial Client AID Rotaion in Support of Passcode Rotation<a href="#partial-client-aid-rotaion-in-support-of-passcode-rotation" class="hash-link" aria-label="Direct link to Partial Client AID Rotaion in Support of Passcode Rotation" title="Direct link to Partial Client AID Rotaion in Support of Passcode Rotation">​</a></h2><p>To provide post-quantum secure passcode recovery, a passcode recovery must be accompanied by partial rotation of the Client AID. This partial rotation is possible because the user will have to provide both old and new passcodes to initiate the process.</p><p>The partial rotation of the Client AID is accomplished by using the old passcode to regenerate the the prior rotation key pair called <code>R0</code> from the latest establishment event.  In addition, two new key pairs are generated from the new passocde, one used for signing authority (S0) and one used for rotation authority (R1) in the new rotation event.</p><p>The public key for <code>S0</code> is used as the first signing key in the new rotation event; it is giving a fractionally weighted threshold of &quot;1&quot;.  The public key for <code>R0</code> is used as the second signing key in the new rotation event; it is giving a fractionally weighted threshold of &quot;0&quot;.  A Blake3 has is created of the public key for <code>R1</code> and is used as the next rotation key commitment.</p><p>The rotation event is signed with the private keys of both <code>S0</code> and <code>R0</code>.  An example of a partial rotation event of the Client AID from above follows with its signatures:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;v&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KERI10JSON000195_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;t&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EGTAY6x1tTbOO27LCy3poh5iW0Oa2Cq1s7wsVnj152Zi&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;i&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELI7pg979AdhmvrjDeam2eAO2SR5niCgnjAJXJHtJose&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;s&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELI7pg979AdhmvrjDeam2eAO2SR5niCgnjAJXJHtJose&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;kt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Threshold for key derived from NEW passcode, has full signing authority</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Threshold for key derived from OLD passcode, no signing authority</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;k&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;DAbWjobbaLqRB94KiAutAHb_qzPpOHm3LURA_ksxetVc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Derived from NEW passcode as salt, kidx = 0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;DHMAZEksiqGxlNKnm0pSAyMRPK1ZKyBfGV8q_B9r6pLs&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Derived from OLD passcode as salt, kidx = 1 (matches previous rotation key)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;nt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;EIFG_uqfr1yN560LoHYHfvPAhxQ5sN6xZZT_E3h7d2tL&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Derived from NEW passcode as salt, kidx = 1, Blake3 Hashed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;bt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;br&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;ba&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the following attached signatures:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;AADuzJ4zU8MkLBPP8Os9UPbTvNqoQ4YDImNkTjfknWgJW25V6EmwZ59PXas0zKhxtp_dOhvkPqtqIhgarOFwt7sC&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;2AABAACRZGDB7s4hmYnt7vTYGWCawhnqHndWUy_rtR_L8mfNmrJ4N5S05wAZ6w5RoL68h1HjIzO7ZuiF30XBz1cC6eUA&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first signature satisfies the current signing threshold and has only one index, 0 for signing key index.  The second signature satifies the prior rotation threshold and thus uses dual index code to specify a current signing index of 1 and a prior signing index of 0.</p><p>The following steps are followed to accept the passcode rotation:</p><ol><li>Verify and accept the Client AID rotation</li><li>Verify the signature on the request against the NEW signing key of the Client AID</li><li>Save encrypted old passcode</li><li>Update all Salty Key encrypted salts</li><li>Update all Randy Key encrypted keys</li><li>Delete encrypted old passcode</li></ol></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headerpasscode-rotation-recovery"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-passcode-rotation-recovery" aria-expanded="false" aria-controls="accordeon-passcode-rotation-recovery">passcode-rotation-recovery, level 1</button><a href="#headerpasscode-rotation-recovery" class="hash-link" aria-label="Direct link to headerpasscode-rotation-recovery" title="Direct link to headerpasscode-rotation-recovery">​</a></h2><div id="accordeon-passcode-rotation-recovery" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="passcode-rotation-recovery">Passcode Rotation Recovery<a href="#passcode-rotation-recovery" class="hash-link" aria-label="Direct link to Passcode Rotation Recovery" title="Direct link to Passcode Rotation Recovery">​</a></h2><p>When each Agent Worker is loaded it will check for a saved old passcode to detect an aborted passcode rotation.  If a saved encrypted old passcode is found the Agent Worker will
notify the client in the response to the state call that a passcode rotation recovery is needed and lock out all other operations until it is completed successfully.</p><p>To perform a passcode rotation recovery, the Signify Client requires only the new passcode and must perform the following steps:</p><ol><li>Retrieve the encrypted old passcode and decrypt it with X25519 key generated from the new passcode.</li><li>Perform a revised partial rotation of the Client AID where you rotate out to a new next key not new signing key.</li><li>Attempt to decrypt all salts with the X25519 keys from both the old and new passcode for Salty Keys</li><li>For any salt still encrypted with the old passcode, encrypt with X25519 key from new passcode </li><li>Attempt to decrypt all keys with the X25519 keys from both the old and new passcode for Randy Keys</li><li>Validate them against current public keys and for any key still encrypted with the old passcode, encrypt with X25519 key from new passcode</li><li>Send all rotation event and all recrypted material in a POST request to the agent on <code>/agent/&lt;Client AID&gt;</code></li></ol></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersignify-request-response-authentication"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-signify-request-response-authentication" aria-expanded="false" aria-controls="accordeon-signify-request-response-authentication">signify-request-response-authentication, level 1</button><a href="#headersignify-request-response-authentication" class="hash-link" aria-label="Direct link to headersignify-request-response-authentication" title="Direct link to headersignify-request-response-authentication">​</a></h2><div id="accordeon-signify-request-response-authentication" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signify-requestresponse-authentication">Signify Request/Response Authentication<a href="#signify-requestresponse-authentication" class="hash-link" aria-label="Direct link to Signify Request/Response Authentication" title="Direct link to Signify Request/Response Authentication">​</a></h2><p>Signify clients must sign all requests to the KERIA Admin Interface using the latest signing key of the Client AID and must expect all responses from the KERIA service be signed by the latest signing key of the Agent AID.  Both request and response signing rely on the same set of HTTP headers to accomplish request/response signing.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headermetadata-headers"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-metadata-headers" aria-expanded="false" aria-controls="accordeon-metadata-headers">metadata-headers, level 1</button><a href="#headermetadata-headers" class="hash-link" aria-label="Direct link to headermetadata-headers" title="Direct link to headermetadata-headers">​</a></h2><div id="accordeon-metadata-headers" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-headers">Metadata Headers<a href="#metadata-headers" class="hash-link" aria-label="Direct link to Metadata Headers" title="Direct link to Metadata Headers">​</a></h2><p>Document <code>Signify-Resource</code> and <code>Signify-Timestamp</code> headers here.</p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersignature-input-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-signature-input-header" aria-expanded="false" aria-controls="accordeon-signature-input-header">signature-input-header, level 1</button><a href="#headersignature-input-header" class="hash-link" aria-label="Direct link to headersignature-input-header" title="Direct link to headersignature-input-header">​</a></h2><div id="accordeon-signature-input-header" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signature-input-header">Signature Input Header<a href="#signature-input-header" class="hash-link" aria-label="Direct link to Signature Input Header" title="Direct link to Signature Input Header">​</a></h2><p>Document the <code>Signagture-Input</code> header here with link to <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-message-signatures.html" target="_blank" rel="noopener noreferrer">https://httpwg.org/http-extensions/draft-ietf-httpbis-message-signatures.html</a></p></div></div></div><div class="accordion-item" data-level="1"><h2 class="anchor anchorWithStickyNavbar_LWe7 accordion-header" id="headersignature-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#accordeon-signature-header" aria-expanded="false" aria-controls="accordeon-signature-header">signature-header, level 1</button><a href="#headersignature-header" class="hash-link" aria-label="Direct link to headersignature-header" title="Direct link to headersignature-header">​</a></h2><div id="accordeon-signature-header" class="accordion-collapse collapse"><div class="accordion-body"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signature-header">Signature Header<a href="#signature-header" class="hash-link" aria-label="Direct link to Signature Header" title="Direct link to Signature Header">​</a></h2><p>Docuemnt the signing method and <code>Signature</code> header.</p></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/WebOfTrust/WOT-terms/tree/main/docs/08_carbon-copies/WebOfTrust-keria-main-docs-protocol.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/WOT-terms/docs/carbon-copies/WebOfTrust-ietf-ipex-main-draft-ssmith-ipex"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">WebOfTrust-ietf-ipex-main-draft-ssmith-ipex</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/WOT-terms/docs/category/gleif"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GLEIF</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#signifykeria-request-authentication-protocol-skrap" class="table-of-contents__link toc-highlight">Signify/KERIA Request Authentication Protocol (SKRAP)</a></li><li><a href="#keria-service-endpoint-interfaces" class="table-of-contents__link toc-highlight">KERIA Service Endpoint Interfaces</a></li><li><a href="#agent-worker-initialization" class="table-of-contents__link toc-highlight">Agent Worker Initialization</a></li><li><a href="#step-one--generate-client-aid" class="table-of-contents__link toc-highlight">Step One:  Generate Client AID</a></li><li><a href="#step-two--agent-worker-creation" class="table-of-contents__link toc-highlight">Step Two:  Agent Worker Creation</a></li><li><a href="#step-three-signify-client-delegation-approval" class="table-of-contents__link toc-highlight">Step Three: Signify Client Delegation Approval</a></li><li><a href="#reconnecting-to-existing-agent-worker" class="table-of-contents__link toc-highlight">Reconnecting to Existing Agent Worker</a></li><li><a href="#key-generate-methods" class="table-of-contents__link toc-highlight">Key Generate Methods</a></li><li><a href="#salty-keys" class="table-of-contents__link toc-highlight">Salty Keys</a></li><li><a href="#salty-key-salt-rotations" class="table-of-contents__link toc-highlight">Salty Key Salt Rotations</a></li><li><a href="#randy-keys" class="table-of-contents__link toc-highlight">Randy Keys</a></li><li><a href="#sandy-keys" class="table-of-contents__link toc-highlight">Sandy Keys</a></li><li><a href="#group-keys" class="table-of-contents__link toc-highlight">Group Keys</a></li><li><a href="#hsm-keys-experimental" class="table-of-contents__link toc-highlight">HSM Keys (Experimental)</a></li><li><a href="#passcode-rotation" class="table-of-contents__link toc-highlight">Passcode Rotation</a></li><li><a href="#partial-client-aid-rotaion-in-support-of-passcode-rotation" class="table-of-contents__link toc-highlight">Partial Client AID Rotaion in Support of Passcode Rotation</a></li><li><a href="#passcode-rotation-recovery" class="table-of-contents__link toc-highlight">Passcode Rotation Recovery</a></li><li><a href="#signify-requestresponse-authentication" class="table-of-contents__link toc-highlight">Signify Request/Response Authentication</a></li><li><a href="#metadata-headers" class="table-of-contents__link toc-highlight">Metadata Headers</a></li><li><a href="#signature-input-header" class="table-of-contents__link toc-highlight">Signature Input Header</a></li><li><a href="#signature-header" class="table-of-contents__link toc-highlight">Signature Header</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/intro/intro">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/category/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/category/education">Education</a></li><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/category/resources">Resources</a></li><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/category/glossary">Glossary</a></li><li class="footer__item"><a class="footer__link-item" href="/WOT-terms/docs/category/how-we-did">How we did</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/weboftrust/WOT-terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/WOT-terms/assets/js/runtime~main.21a352a1.js"></script>
<script src="/WOT-terms/assets/js/main.dccd3833.js"></script>
</body>
</html>